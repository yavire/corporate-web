/**
 * @module       RD Facebook Feed
 * @author       Rafael Shayvolodyan
 * @see          https://ua.linkedin.com/in/rafael-shayvolodyan-3a297b96
 * @see          https://github.com/ZemezPlugins/rd-facebook
 * @version      1.0.2
 */
(function(){!function(t,e,i){var s;return s=function(){function s(s,o){this.options=t.extend(!0,{},this.Defaults,o),this.element=s,this.$element=t(s),this.$win=t(i),this.$doc=t(e),this.$items=this.$element.find("[data-fb-post]"),this.$user=this.$element.find("[data-fb-user]"),this.initialize()}return s.prototype.Defaults={id:"",accessToken:"",showLog:!1,dateFormat:{seconds:"less than a minute ago",minute:"about a minute ago",minutes:" minutes ago",hour:"about an hour ago",hours:" hours ago",day:"1 day ago",days:"%b/%d/%Y"},callbacks:{userLoaded:!1,postsLoaded:!1}},s.prototype.initialize=function(){var e,i,s,o,n,a;if(i=this,n=this.element.getAttribute("data-fb-id")?this.element.getAttribute("data-fb-id"):this.options.id,e=this.element.getAttribute("data-fb-access")?this.element.getAttribute("data-fb-access"):this.options.accessToken,!n)throw new Error("You need to provide an user/page id!");if(!e)throw new Error("You need to provide an access token!");a=i.$items.length,o="https://graph.facebook.com/"+n+"/?fields=name,picture&access_token="+e+"&callback=?",s="https://graph.facebook.com/"+n+"/posts/?&fields=id,from,message,story,story_tags,picture,link,name,icon,privacy,actions,type,status_type,object_id,created_time,updated_time,shares,is_hidden,is_expired,likes.limit(0).summary(true),comments.limit(9999).summary(true)&access_token="+e+"&callback=?&date_format=U&limit="+a,t.when(t.getJSON(o),t.getJSON(s)).done(function(e,s){var o,n;n="true"===i.element.getAttribute("data-fb-showlog")?i.element.getAttribute("data-fb-showlog"):i.options.showLog,n&&(console.log("User: "),console.log(e[0]),console.log("Posts: "),console.log(s[0].data)),o={user:e[0],posts:[]},t.each(s[0].data,function(){var t,e,s,n;if(!this.message)return!0;if(this.from.picture=o.user.picture.data.url,this.message=i.urlHyperlinks(this.message),this.likes?this.likes.count=this.likes.summary.total_count:(this.likes=[],this.likes.count=0),this.comments?this.comments.count=this.comments.summary.total_count:(this.comments=[],this.comments.count=0),null!=this.actions?null!=this.actions[0]&&"Share"===this.actions[0].name&&(this.postlink=this.actions[0].link):this.postlink=this.link,null!=this.comments.data)for(n=this.comments.data,e=0,s=n.length;s>e;e++)t=n[e],t.from.link="https://facebook.com/"+t.from.id;o.posts.push(this)}),i.loopData(o.user,!0),i.loopData(o.posts,!1)})},s.prototype.dating=function(t,e){var i,s,o,n,a,r,u,l,c,d,h,m;if(o=new Date(1e3*t),s=new Date,a=parseInt((s.getTime()-o.getTime())/1e3),a+=60*(-120-s.getTimezoneOffset()),m=["January","February","March","April","May","June","July","August","September","October","November","December"],i={"%d":o.getDate(),"%m":o.getMonth()+1,"%b":m[o.getMonth()].substring(0,3),"%B":m[o.getMonth()],"%y":String(o.getFullYear()).slice(-2),"%Y":o.getFullYear()},e){for(n="%Y-%m-%d",u=n.match(/%[dmbByY]/g),l=0,d=u.length;d>l;l++)r=u[l],n=n.replace(r,i[r]);return n}if(n=this.element.getAttribute("data-fb-date-format")?this.element.getAttribute("data-fb-date-format"):this.options.dateFormat.days,60>a)return this.options.dateFormat.seconds;if(120>a)return this.options.dateFormat.minute;if(3600>a)return parseInt(a/60).toString()+this.options.dateFormat.minutes;if(7200>a)return this.options.dateFormat.hour;if(86400>a)return"about "+parseInt(a/3600).toString()+this.options.dateFormat.hours;if(172800>a)return this.options.dateFormat.day;for(u=n.match(/%[dmbByY]/g),c=0,h=u.length;h>c;c++)r=u[c],n=n.replace(r,i[r]);return n},s.prototype.urlHyperlinks=function(t){return t.replace(/\b((http|https):\/\/\S+)/g,'<a href="$1" target="_blank">$1</a>')},s.prototype.loopData=function(t,e){var i,s,o;if(i=this,null!=i.interval&&clearInterval(i.interval),e)i.$user.find("*").each(function(){return i.parseAttributes(this,t,0)}),i.options.callbacks.userLoaded&&i.options.callbacks.userLoaded.call(this,i);else{if(Array.isArray(t))for(s=0;s<t.length;)o={likes:-1,comments:-1},i.$items.eq(s).find("*").each(function(){return i.checkAttribute(this,"data-fb-like")?void o.likes++:i.checkAttribute(this,"data-fb-comment")?void o.comments++:void(i.checkAttribute(this,"data-likes")?i.parseAttributes(this,t[s],o.likes):i.checkAttribute(this,"data-comments")?i.parseAttributes(this,t[s],o.comments):i.parseAttributes(this,t[s],0))}),s++;i.options.callbacks.postsLoaded&&i.options.callbacks.postsLoaded.call(this,i)}},s.prototype.checkAttribute=function(t,e){var i,s,o,n;for(n=t.attributes,s=0,o=n.length;o>s;s++)if(i=n[s],i.name.indexOf(e)>-1)return!0;return!1},s.prototype.parseAttributes=function(e,i,s){var o,n,a,r,u,l,c,d,h,m,f,p,b,g;a=e.attributes;for(r in a)if(null!=a[r]&&"data-remove"!==a[r].name&&"object"==typeof a[r]&&-1!==a[r].name.indexOf("data-")&&-1===a[r].name.indexOf("data-fb-")){if(g=a[r].name.substring(5),p=null,-1!==g.indexOf("-"))for(b=g.split("-"),p=i,l=0,d=b.length;d>l;l++)if(f=b[l],"data"===f&&null!=p[f]&&null!=p[f][s])p=p[f][s];else if(null!=p[f])p=p[f];else{if(!e.hasAttribute("data-remove"))continue;t(e).remove()}if("string"==typeof a[r].value&&(n=a[r].value.split(/\s?,\s?/i),null!=p?m=p:null!=i[g]&&(m=i[g]),-1!==g.indexOf("created_time")&&(u=m),null!=m&&null!=n&&("string"==typeof m||"number"==typeof m)))for(c=0,h=n.length;h>c;c++)o=n[c],-1!==g.indexOf("created_time")&&(m="datetime"===o?this.dating(u,!0):this.dating(u,!1)),"text"===o.toLowerCase()?e.innerHTML=m:e.setAttribute(o,m)}},s.prototype.getOption=function(t){var e,s;if(null!=this.options.responsive){for(e in this.options.responsive)e<=i.innerWidth&&(s=e);return null!=this.options.responsive[s][t]?this.options.responsive[s][t]:this.options[t]}return this.options[t]},s}(),t.fn.extend({RDFacebookFeed:function(e){return this.each(function(){var i;return i=t(this),i.data("RDFacebookFeed")?void 0:i.data("RDFacebookFeed",new s(this,e))})}}),i.RDFacebookFeed=s}(window.jQuery,document,window),"undefined"!=typeof module&&null!==module?module.exports=window.RDFacebookFeed:"function"==typeof define&&define.amd&&define(["jquery"],function(){"use strict";return window.RDFacebookFeed})}).call(this);
